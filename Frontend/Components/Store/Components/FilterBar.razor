@using Frontend.Models


<h3>FilterBar</h3>

<button class="btn btn-outline-secondary mb-2" @onclick="ToggleFilter">
    @(_showFilters ? "Hide Filters" : "Show Filters")
</button>

@if (_showFilters)
{
    <div class="mb-3">
        <input @bind="Filter.SearchTerm" placeholder="Search..." class="form-control mb-2" />
        <select @bind="Filter.SelectedGenre" class="form-control mb-2">
            <option value="">Genres</option>
            @foreach (var g in Genres)
            {
                <option value="@g">@g</option>
            }
        </select>

        <div class="d-flex gap-2 mb-2">
            <input type="number" @bind="Filter.MinPrice" placeholder="Min Price" class="form-control" />
            <input type="number" @bind="Filter.MaxPrice" placeholder="Max Price" class="form-control" />
        </div>

        <button class="btn btn-primary" @onclick="ApplyClicked">Apply Filters</button>
    </div>
}

@code {
    private bool _showFilters = false;

    private void ToggleFilter() => _showFilters = !_showFilters;

    [Parameter] public ProductFilter Filter { get; set; } = new();

    [Parameter] public EventCallback<ProductFilter> OnApplyFilters { get; set; }

    [Parameter] public List<string> Genres { get; set; } = new();

    protected override Task OnInitializedAsync()
    {
        Genres.AddRange(new[] { "Action", "RPG", "Survival Horror", "Roguelike" });
        return Task.CompletedTask;
    }

    private async Task ApplyClicked()
    {
        if (OnApplyFilters.HasDelegate)
            await OnApplyFilters.InvokeAsync(Filter);
    }
}
